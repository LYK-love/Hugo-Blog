<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Shell Script :: LYK-love</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Outline:
Intro Shebang Execute Shell Script I/O redirection " />
<meta name="keywords" content="" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://lyk-love.cn/Hugo-Blog/posts/shell-script/" />






  
  
  
  
  
  <link rel="stylesheet" href="https://lyk-love.cn/Hugo-Blog/styles.css">







  <link rel="shortcut icon" href="https://lyk-love.cn/images/favicon.ico">



<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Shell Script">
<meta property="og:description" content="Outline:
Intro Shebang Execute Shell Script I/O redirection " />
<meta property="og:url" content="https://lyk-love.cn/Hugo-Blog/posts/shell-script/" />
<meta property="og:site_name" content="LYK-love" />

  
    <meta property="og:image" content="https://lyk-love.cn/images/favicon.ico">
  

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">


  <meta property="article:published_time" content="2023-04-23 20:53:12 &#43;0000 UTC" />









<style>
     
     
     
     
     
     
     
     
     
     
     



     
     
     
     
     
     

     
     
     
     
     

     
     
     
     
     
     
     
     

     
     
     
     
     
     

     
     
     
     
     

     
     
     
     
     

    #search-btn {
        position: absolute;
        top: 10px;
        right: 20px;
        font: font: inherit;
        font-size: 130%;
        background: inherit;
        border: inherit;
        color: inherit;
    }


</style>




<style>
    .back-to-top {
        box-sizing: border-box;
        border-radius: 8px;        
        position: fixed;
        right: 30px;
        z-index: 1050;
        padding: 0 6px;
        width: initial;
        background: #222;
        font-size: 12px;
        opacity: 0.6;
        color: #fff;
        cursor: pointer;
        text-align: center;
        transition-property: bottom;
        transition-duration: 0.2s;
        transition-timing-function: ease-in-out;
        transition-delay: 0s;
        bottom: -40px;
    }

    .back-top-active {
        bottom: 30px;
    }

    @media (max-width: 767px) {

        .back-to-top {
            right: 10px;
        }


        .back-top-active {
            bottom: 10px;
        }
    }
</style>


<script src="https://kit.fontawesome.com/36e579b0cd.js" crossorigin="anonymous"></script>

<style>
     
    .post-toc {
        position: absolute;
        width: 200px;
        margin-left: 780px;
        padding: 10px;
        word-wrap: break-word;
        box-sizing: border-box;
    .post-toc-title {
        margin: 0;
        font-weight: 400;
        text-transform: uppercase;
    }
    .post-toc-content {
    &.always-active ul {
         display: block;
     }
    >nav>ul {
        margin: 10px 0;
    }
    ul {
        padding-left: 0;
        list-style: none;
    ul {
        padding-left: 15px;
        display: none;
    }
    .has-active > ul {
        display: block;
    }
    }
    }
    a:hover {
        color: #c05b4d;
        -webkit-transform: scale(1.1);
        -ms-transform: scale(1.1);
        transform: scale(1.1);
    }
    a {
        display: block;
        line-height: 30px;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
        -webkit-transition-duration: .2s;
        transition-duration: .2s;
        -webkit-transition-property: -webkit-transform;
        transition-property: -webkit-transform;
        transition-property: transform;
        transition-property: transform,-webkit-transform;
        -webkit-transition-timing-function: ease-out;
        transition-timing-function: ease-out;
    }
    }
    @media only screen and (max-width: 1224px) {
        .post-toc {
            display: none;
        }
    }
</style>








































</head>
<body class="green">


<div class="container center headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    LYK-love
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/Hugo-Blog/about">About</a></li>
        
      
        
          <li><a href="/Hugo-Blog/archive">Archive</a></li>
        
      
        
          <li><a href="/Hugo-Blog/tags">Tags</a></li>
        
      
        
          <li><a href="/Hugo-Blog/categories">Categories</a></li>
        
      
        
          <li><a href="/Hugo-Blog/research">Research</a></li>
        
      
        
          <li><a href="/Hugo-Blog/code">Code</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/Hugo-Blog/about" >About</a></li>
        
      
        
          <li><a href="/Hugo-Blog/archive" >Archive</a></li>
        
      
        
          <li><a href="/Hugo-Blog/tags" >Tags</a></li>
        
      
        
          <li><a href="/Hugo-Blog/categories" >Categories</a></li>
        
      
      
        <li>
          <ul class="menu">
            <li class="menu__trigger">Show more&nbsp;▾</li>
            <li>
              <ul class="menu__dropdown">
                
                  
                    <li><a href="/Hugo-Blog/research" >Research</a></li>
                  
                
                  
                    <li><a href="/Hugo-Blog/code" >Code</a></li>
                  
                
              </ul>
            </li>
          </ul>
        </li>
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://lyk-love.cn/Hugo-Blog/posts/shell-script/">Shell Script</a>
  </h1>
  <div class="post-meta">
    
      <time class="post-date">
        2023-04-23 ::
        
      </time>
    
    
    
  </div>

  
    <span class="post-tags">
      
      #<a href="https://lyk-love.cn/Hugo-Blog/tags/shell/">shell</a>&nbsp;
      
      #<a href="https://lyk-love.cn/Hugo-Blog/tags/linux/">Linux</a>&nbsp;
      
    </span>
  
  


  
    <div class="table-of-contents">
      <h2>
        Contents
      </h2>
      <nav id="TableOfContents">
  <ul>
    <li><a href="#scripts-vs-shell-functions">scripts vs shell functions</a></li>
    <li><a href="#shell-style">Shell Style</a></li>
  </ul>

  <ul>
    <li><a href="#shebang-with-env">shebang with env</a></li>
  </ul>

  <ul>
    <li><a href="#here-document">Here Document</a></li>
  </ul>
</nav>
    </div>
  

  <div class="post-content"><div>
        <p>Outline:</p>
<ul>
<li>Intro</li>
<li>Shebang</li>
<li>Execute Shell Script</li>
<li>I/O redirection</li>
</ul>
<h1 id="intro">Intro<a href="#intro" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p><a href="https://github.com/onceupon/Bash-Oneliner">常见Shell指令</a></p>
<h2 id="scripts-vs-shell-functions">scripts vs shell functions<a href="#scripts-vs-shell-functions" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>Some differences between shell functions and scripts that you should keep in mind are:</p>
<ul>
<li>Functions have to be in the same language as the shell, while scripts can be written in any language. This is why including a shebang for scripts is important.</li>
<li>Functions are loaded once when their definition is read. Scripts are loaded every time they are executed. This makes functions slightly faster to load, but whenever you change them you will have to reload their definition.</li>
<li>Functions are executed <strong>in the current shell environment</strong>( 可以简单理解为， function的所在路径是当前路径 ) whereas scripts execute in their own process. Thus, functions can modify environment variables, e.g. change your current directory, whereas scripts can’t. Scripts will be passed by value environment variables that have been exported using <a href="https://www.man7.org/linux/man-pages/man1/export.1p.html"><code>export</code></a></li>
<li>As with any programming language, functions are a powerful construct to achieve modularity, code reuse, and clarity of shell code. Often shell scripts will include their own function definitions.</li>
</ul>
<h2 id="shell-style">Shell Style<a href="#shell-style" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p><a href="https://google.github.io/styleguide/shellguide.html">https://google.github.io/styleguide/shellguide.html</a></p>
<h1 id="shebang">Shebang<a href="#shebang" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>Note that scripts need not necessarily be written in bash to be called from the terminal. For instance, here’s a simple Python script that outputs its arguments in reversed order:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/local/bin/python
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>import sys
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> arg in reversed<span style="color:#f92672">(</span>sys.argv<span style="color:#f92672">[</span>1:<span style="color:#f92672">])</span>:
</span></span><span style="display:flex;"><span>    print<span style="color:#f92672">(</span>arg<span style="color:#f92672">)</span>
</span></span></code></pre></div><ul>
<li>
<p>shebang: the character sequence consisting of <code>#!</code> at the beginning of a script in   a <a href="https://en.wikipedia.org/wiki/Unix-like">Unix-like</a> operating system</p>
<ul>
<li>
<p>shell会将shebang中<code>#!</code>之后的内容作为一个程序的路径，打开该程序， 将本script的路径当作参数传入( 即: 将整个script当作input传入shebang所指定的程序 ）</p>
</li>
<li>
<p>For example, if a script is named with the path <em>path/to/script</em>, and it starts with the following line, <code>#!/bin/sh</code>, then the program loader is instructed to run the program <em>/bin/sh</em>, passing <em>path/to/script</em> as the first argument. In <a href="https://en.wikipedia.org/wiki/Linux">Linux</a>, this behavior is the result of both kernel and user-space code.[<a href="https://en.wikipedia.org/wiki/Shebang_(Unix)#cite_note-9">9]</a></p>
</li>
<li>
<p>The shebang line is usually ignored by the interpreter, because the &ldquo;#&rdquo; character is a <a href="https://en.wikipedia.org/wiki/Comment_(computer_programming)">comment</a> marker in many scripting languages; some language interpreters that do not use the hash mark to begin comments still may ignore the shebang line in recognition of its purpose.</p>
</li>
</ul>
</li>
</ul>
<h2 id="shebang-with-env">shebang with env<a href="#shebang-with-env" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>The shebang expects a full path to the interpreter to use so the following syntax would be incorrect:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e">#!python</span>
</span></span></code></pre></div><p>Setting a full path like this might work:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/local/bin/python</span>
</span></span></code></pre></div><p>but would be non portable as python might be installed in <code>/bin</code>, <code>/opt/python/bin</code>, or wherever other location.</p>
<p>Using <code>env</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python</span>
</span></span></code></pre></div><p>is a method allowing a portable way to specify to the OS a full path equivalent to the one where <code>python</code> is first located in the <code>PATH</code>.</p>
<h1 id="execute-shell-script">Execute Shell Script<a href="#execute-shell-script" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>执行脚本文件：</p>
<ol>
<li>
<p>直接指定<code>sh</code>来执行该脚本，不需要shebang，也不需要脚本有执行权限（因为该脚本直接作为参数传给了sh).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>sh script_file_path
</span></span></code></pre></div></li>
<li>
<p>需要写shebang来指定解释器, 并且要指定脚本路径.</p>
<p>必须加上<code>./</code>使得该command name被识别为一个路径名. 否则shell会继续在alias, builtin和<code>PATH</code>中搜索该command name. <sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>chmod +x script_file <span style="color:#75715e">##(chown, chgrp optionally)</span>
</span></span><span style="display:flex;"><span>./script_file
</span></span></code></pre></div></li>
<li>
<p>使用<code>.</code>或<code>source</code>在当前shell session中执行该脚本</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>source script_file
</span></span></code></pre></div><p>or</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>. script_file
</span></span></code></pre></div><p>因此, 该方法可以用于刷新当前shell环境:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>source ~/.bashrc
</span></span></code></pre></div></li>
<li>
<p>Shell script是能在命令行直接输入的, 但仅会作用一次</p>
</li>
</ol>
<p>注意: 方法1,2都是新开一个子shell session，在其中执行脚本，而方法3, 4是在当前shell session中执行脚本</p>
<h1 id="io-redirection">I/O redirection<a href="#io-redirection" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<p>一般情况下，每个 Linux 命令运行时都会打开三个文件：</p>
<ul>
<li>标准输入文件(stdin)：stdin的文件描述符为0，Unix程序默认从stdin读取数据。</li>
<li>标准输出文件(stdout)：stdout 的文件描述符为1，Unix程序默认向stdout输出数据。</li>
<li>标准错误文件(stderr)：stderr的文件描述符为2，Unix程序会向stderr流中写入错误信息</li>
</ul>
<ul>
<li>
<p>Discard the output</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ command &gt; /dev/null
</span></span></code></pre></div><p>The file <strong>/dev/null</strong> is a special file that automatically <strong>discards all its input</strong>.</p>
</li>
<li>
<p>Discard both output of a command and its error output,</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>$ command &gt; /dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>
</span></span></code></pre></div><ul>
<li>a command normally writes its output to <strong>STDOUT</strong></li>
<li>use standard redirection to redirect <strong>STDERR</strong> to <strong>STDOUT</strong></li>
<li>这里<code>2&gt;&amp;1</code>将标准错误（2）合并到标准输出（1）， 而标准输出已经被重定向到了<code>/dev/null</code>, 因此总体效果是，标准错误和输出都被重定向到了<code>/dev/null</code></li>
</ul>
</li>
<li>
<p>file descriptor:</p>
<ul>
<li><strong>0</strong> : STDIN</li>
<li><strong>1</strong>: STDOUT</li>
<li><strong>2</strong>: STDERR</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">Sr.No.</th>
<th style="text-align:center">Command &amp; Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center"><strong>pgm &gt; file</strong><!-- raw HTML omitted -->Output of pgm is redirected to file<!-- raw HTML omitted -->会覆盖目标文件中原有的数据</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center"><strong>pgm &lt; file</strong><!-- raw HTML omitted -->Program pgm reads its input from file</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center"><strong>pgm &raquo; file</strong><!-- raw HTML omitted -->Output of pgm is appended to file</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center"><strong>n &gt; file</strong><!-- raw HTML omitted -->Output from stream with descriptor <strong>n</strong> redirected to file</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center"><strong>n &raquo; file</strong><!-- raw HTML omitted -->Output from stream with descriptor <strong>n</strong> appended to file</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center"><strong>n &gt;&amp; m</strong><!-- raw HTML omitted -->Merges output from stream <strong>n</strong> with stream <strong>m</strong></td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center"><strong>n &lt;&amp; m</strong><!-- raw HTML omitted -->Merges input from stream <strong>n</strong> with stream <strong>m</strong></td>
</tr>
<tr>
<td style="text-align:center">8</td>
<td style="text-align:center"><strong>&laquo; tag</strong><!-- raw HTML omitted -->Standard input comes from here through next tag at the start of line</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center"><strong>|</strong><!-- raw HTML omitted -->Takes output from one program, or process, and sends it to another</td>
</tr>
</tbody>
</table>
<h2 id="here-document">Here Document<a href="#here-document" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>Here Document 目前没有统一的翻译，这里暂译为”嵌入文档“。Here Document 是 Shell 中的一种特殊的重定向方式，它的基本的形式如下：</p>
<pre tabindex="0"><code>command &lt;&lt; delimiter
document
delimiter
</code></pre><p>它的作用是<strong>将两个 delimiter 之间的内容(document) 作为输入传递给 command</strong></p>
<p>注意：</p>
<ul>
<li>结尾的delimiter 一定要顶格写，前面不能有任何字符，后面也不能有任何字符，包括空格和 tab 缩进。</li>
<li>开始的delimiter前后的空格会被忽略掉。</li>
</ul>
<p>下面的例子，通过 wc -l 命令计算 document 的行数：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>wc -l <span style="color:#e6db74">&lt;&lt; EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    This is a simple lookup program
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    for good (and bad) restaurants
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    in Cape Town.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span></code></pre></div><p>也可将 Here Document 用在脚本中，例如：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#75715e">#!/bin/bash
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>cat <span style="color:#e6db74">&lt;&lt; EOF
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    This is a simple lookup program
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    for good (and bad) restaurants
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    in Cape Town.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOF</span>
</span></span></code></pre></div><h1 id="commen-shell-scripts">Commen Shell Scripts<a href="#commen-shell-scripts" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h1>
<ul>
<li><code>:</code>： 空命令</li>
</ul>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://lyk-love.cn/2023/04/24/Shell-Script-Searching-Path/">https://lyk-love.cn/2023/04/24/Shell-Script-Searching-Path/</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
      </div></div>

  
    
<div class="pagination">
    <div class="pagination__title">
        <span class="pagination__title-h">Read other posts</span>
        <hr />
    </div>
    <div class="pagination__buttons">
        
        <span class="button previous">
            <a href="https://lyk-love.cn/Hugo-Blog/posts/shell-script-searching-path/">
                <span class="button__icon">←</span>
                <span class="button__text">Shell Script Searching Path</span>
            </a>
        </span>
        
        
        <span class="button next">
            <a href="https://lyk-love.cn/Hugo-Blog/posts/%E7%81%AB%E9%B8%9F/">
                <span class="button__text">火鸟</span>
                <span class="button__icon">→</span>
            </a>
        </span>
        
    </div>
</div>

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2023 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/Hugo-Blog/bundle.min.js"></script>



<a id="search-btn" style="display: inline-block;" href="javascript:void(0);">
  <span class="icon-search">Search</span>
</a>











<script>
  
  
  
  
  var search_page_relative_url = "/search"
  
  
  
  document.addEventListener('keydown', function(event) {

    
    if (event.altKey && event.which === 191) {
      
      
      navToSearchPage(event)
    }

    
    if (event.keyCode == 27) {
      navToHomePage()
    }
  });


  document.querySelector("#search-btn").onclick = function(e) {
    e.stopPropagation();
    navToSearchPage()
  }


  function navToHomePage() {
    window.location.href = "/"
  }

  function navToSearchPage() {
    window.location.href = search_page_relative_url
    
    
    
  }
</script>



<div class="footer-box">
  
  <div class="back-to-top" id="back_to_top">
    
    
    
    <span><i class="fas fa-arrow-up"></i></span> 
    
    <span class="scrollpercent">
            <span id="back_to_top_text">0</span>%
         </span>
  </div>
</div>
<script>
  let sideBarOpen = 'sidebar-open';
  let body = document.body;
  let back2Top = document.querySelector('#back_to_top'),
          back2TopText = document.querySelector('#back_to_top_text'),
          drawerBox = document.querySelector('#drawer_box'),
          rightSideBar = document.querySelector('.sidebar'),
          viewport = document.querySelector('body');

  function scrollAnimation(currentY, targetY) {

    let needScrollTop = targetY - currentY
    let _currentY = currentY
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10)
      _currentY += dist
      window.scrollTo(_currentY, currentY)
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY)
      } else {
        window.scrollTo(_currentY, targetY)
      }
    }, 1)
  }

  back2Top.addEventListener("click", function (e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });

  window.addEventListener('scroll', function (e) {
    let percent = document.scrollingElement.scrollTop / (document.scrollingElement.scrollHeight - document.scrollingElement.clientHeight) * 100;
    if (percent > 1 && !back2Top.classList.contains('back-top-active')) {
      back2Top.classList.add('back-top-active');
    }
    if (percent == 0) {
      back2Top.classList.remove('back-top-active');
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });
  let hasCacu = false;
  window.onresize = function () {
    calcuHeight();
  }
</script>


  
</div>


</body>
</html>
